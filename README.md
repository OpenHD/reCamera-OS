- [1. Official reference](#1-official-reference)
- [2. How to start](#2-how-to-start)
  - [2.1. Preparation](#21-preparation)
  - [2.2 Checkout code](#22-checkout-code)
  - [2.3 Build](#23-build)
  - [2.4 Flashing](#24-flashing)

## 1. Official reference

- [Developer Portal](https://developer.sophgo.com/thread/471.html)

## 2. How to start

### 2.1. Preparation

- Recommended OS: Ubuntu 20.04.6 LTS
- Recommended C/C++: GCC/G++ 9.4.0
- Recommended minimum free space: 30 GB
- Install dependencies

    ```bash
    sudo apt update
    sudo apt install -y libbz2-dev build-essential ninja-build automake autoconf libtool wget curl git gcc \
        libssl-dev bc slib squashfs-tools android-sdk-libsparse-utils android-sdk-ext4-utils jq \
        python3-distutils tclsh scons parallel ssh-client tree python3-dev python3-pip \
        device-tree-compiler libssl-dev ssh cpio squashfs-tools fakeroot libncurses5 flex bison mtools python-is-python3
    pip install cmake jinja2
    ```

    Note: The minimum required cmake version is 3.16.5

### 2.2 Checkout code

- Clone the Repository

    ```bash
    git clone https://github.com/Seeed-Studio/reCamera.git -b sg200x-reCamera
    cd reCamera
    git submodule init
    git submodule update --depth 1
    ```

- Update Submodules (optional)

    ```bash
    ./scripts/repo_clone.sh --gitpull external/subtree.xml
    ```

### 2.3 Build

- Location of the ${project}_defconfig
  
    ```bash
    ls external/configs/
    sg2002_recamera_emmc_defconfig  sg2002_recamera_sd_defconfig  sg2002_xiao_sd_defconfig
    ```

- Building the Project
  
    ```bash
    make ${project}
    ```

    Example:
    ```bash
    make sg2002_recamera_emmc
    ```

- Location of the Build Targets

    ```bash
    ls -l output/${project}/install/soc_${project}/${project}
    ```

    Example:

    ```bash
    cd output/sg2002_recamera_emmc/install/soc_sg2002_recamera_emmc/
    ls -l *.zip
    sg2002_reCamera_0.0.1_emmc_ota.zip
    sg2002_reCamera_0.0.1_emmc_recovery.zip
    sg2002_reCamera_0.0.1_emmc_sd_compat.zip
    sg2002_reCamera_0.0.1_emmc.zip
    ```

### 2.4 Flashing

- Booting from eMMC (Example: sg2002_reCamera_0.0.1_emmc.zip)

    - Install windows driver: [CviUsbDownloadInstallDriver.zip](https://github.com/Seeed-Studio/reCamera/releases/download/0.0.1/CviUsbDownloadInstallDriver.zip)
    - Unzip the [CviBurn_v2.0_cli_windows.zip](https://github.com/Seeed-Studio/reCamera/releases/download/0.0.1/CviBurn_v2.0_cli_windows.zip) package.
    - Unzip the package generated by [Section 2.3](#23-build), for example:
      ./output/sg2002_recamera_emmc/install/soc_sg2002_recamera_emmc/sg2002_reCamera_0.0.1_emmc.zip
    - Execute the following command in Windows (use [-m xx:xx:xx:xx:xx:xx] to configure the Ethernet MAC address):
        `usb_dl.exe -c cv181x -s linux -i ..\sg2002_reCamera_0.0.1_emmc [-m xx:xx:xx:xx:xx:xx]`

- SD Card recovery (Example: sg2002_reCamera_0.0.1_emmc_recovery.zip)

    - Use [balenaEtcher](https://etcher.balena.io/#download-etcher) to flash the `sg2002_reCamera_0.0.1_emmc_recovery.zip` file into the SD card.
    - Then insert the SD card into the board, and power on. It will automatically burn image into emmc.

- Booting from SD Card (Example: sg2002_reCamera_0.0.1_emmc_sd_compat.zip)

    - Use [balenaEtcher](https://etcher.balena.io/#download-etcher) to flash the `sg2002_reCamera_0.0.1_emmc_sd_compat.zip` file into the SD card.
    - Then insert the SD card into the board, and power on. The board will booting from SD card.

- OTA (Example: sg2002_reCamera_0.0.1_emmc_ota.zip)
    
    - This image is specifically designed for OTA updates via the WebUI.
